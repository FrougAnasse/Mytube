{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React from'react';import'./App.css';import Nav from'./component/Nav';import AdminVideo from'./component/AdminVideo';import AdminVideoSelected from'./component/AdminVideoSelected';import AdminUpload from'./component/AdminUpload';import AdminVideoJaime from'./component/AdminVideoJaime';//firebase\nimport base from'./base';//react router\nimport{BrowserRouter as Router,Route}from'react-router-dom';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.handleSearch=function(value){_this.setState({search:value});};_this.disconnecte=function(){_this.setState({user:''});};_this.handleUser=function(value){_this.setState({user:value});};_this.handleVue=function(key){var mytube=_objectSpread({},_this.state.mytube);mytube.video[key].vue++;_this.setState({mytube:mytube});var videoSelected=key;_this.setState({videoSelected:videoSelected});};_this.isAlreadyLike=function(keyVideo){var mytube=_objectSpread({},_this.state.mytube);var Already=false;if(mytube!==undefined){Object.keys(mytube.video[keyVideo].likeBy||{}).forEach(function(key){if(key===_this.state.user.uid){if(mytube.video[keyVideo].likeBy[_this.state.user.uid]===1){Already=true;}}});return Already;}};_this.handleLike=function(key){if(_this.state.user.uid!==undefined){var mytube=_objectSpread({},_this.state.mytube);if(mytube.video[key].likeBy===undefined){mytube.video[key].likeBy={};}if(mytube.video[key].likeBy[_this.state.user.uid]===undefined||mytube.video[key].likeBy[_this.state.user.uid]===0){mytube.video[key].like++;mytube.video[key].likeBy[_this.state.user.uid]=1;}else{mytube.video[key].like--;mytube.video[key].likeBy[_this.state.user.uid]=0;}_this.setState({mytube:mytube});}};_this.getPseudo=function(uid){var Testuser=_objectSpread({},_this.state.mytube.user);var pseudo='';Object.keys(Testuser||{})//on vérifie que le compte n'a pas déja été créer\n.forEach(function(key){if(Testuser[key].uid===uid){pseudo=Testuser[key].pseudo;}});return pseudo;};_this.addNewUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(uid,pseudo){var mytube,newUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:mytube=_objectSpread({},_this.state.mytube);newUser={uid:uid,pseudo:pseudo};console.log(newUser.pseudo);mytube.user[\"user-\".concat(Date.now())]=newUser;_this.setState({mytube:mytube});return _context.abrupt(\"return\",newUser);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this.getUser=function(uid,pseudo){var Testuser=_objectSpread({},_this.state.mytube.user);var newUser={};Object.keys(Testuser)//on vérifie que le compte n'a pas déja été créer\n.forEach(function(key){if(Testuser[key].uid===uid){newUser=Testuser[key];}});if(newUser.uid===undefined){//si aucun compte n'a été ctrouver on en créer un\nnewUser=_this.addNewUser(uid,pseudo);}_this.setState({user:newUser});};_this.addVideo=function(nom,tags,url){var mytube=_objectSpread({},_this.state.mytube);var NewVideo={auteur:_this.state.user.pseudo,comment:{},like:0,likeBy:{},nom:nom,tag:tags,url:url,vue:0};mytube.video[\"video\".concat(Date.now())]=NewVideo;_this.setState({mytube:mytube});};_this.addComment=function(key,comment){if(_this.state.user.uid!==undefined){var mytube=_objectSpread({},_this.state.mytube);if(mytube.video[key].comment===undefined||mytube.video[key].comment===''){mytube.video[key].comment={};}var NewComment={auteur:_this.state.user.pseudo,comment:comment};mytube.video[key].comment[Date.now()]=NewComment;_this.setState({mytube:mytube});}};_this.refCard=/*#__PURE__*/React.createRef();_this.refCardVideo=/*#__PURE__*/React.createRef();_this.state={mytube:{},search:'',videoSelected:'',user:{}};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){this.ref=base.syncState(\"/\",{context:this,state:'mytube'});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){base.removeBinding(this.ref);}},{key:\"render\",value:function render(){var _this2=this;//variable permettant la manipulation de la marge lors de l'activation du menu\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(Nav,{state:this.state,getPseudo:this.getPseudo,stateMytube:this.state.mytube.video,handleSearch:this.handleSearch,handleUser:this.handleUser,getUser:this.getUser,disconnecte:this.disconnecte,refCardVideo:this.refCardVideo,refCard:this.refCard}),/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminVideo,{state:_this2.state,stateMytube:_this2.state.mytube.video,handleVue:_this2.handleVue,isAlreadyLike:_this2.isAlreadyLike,refCard:_this2.refCard});}}),/*#__PURE__*/_jsx(Route,{path:\"/videoSelect/:slug\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminVideoSelected,{state:_this2.state,isAlreadyLike:_this2.isAlreadyLike,stateMytube:_this2.state.mytube.video,handleLike:_this2.handleLike,refCardVideo:_this2.refCardVideo,refCard:_this2.refCard,addComment:_this2.addComment,handleVue:_this2.handleVue});}}),/*#__PURE__*/_jsx(Route,{path:\"/upload\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminUpload,{state:_this2.state,stateMytube:_this2.state.mytube.video,addVideo:_this2.addVideo,refCard:_this2.refCard,isAlreadyLike:_this2.isAlreadyLike});}}),/*#__PURE__*/_jsx(Route,{path:\"/video/likes\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminVideoJaime,{state:_this2.state,stateMytube:_this2.state.mytube.video,refCard:_this2.refCard,isAlreadyLike:_this2.isAlreadyLike,typeJaime:true});}})]})});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["C:/Users/VolgoBox/Desktop/Mytube/src/App.js"],"names":["React","Nav","AdminVideo","AdminVideoSelected","AdminUpload","AdminVideoJaime","base","BrowserRouter","Router","Route","App","props","handleSearch","value","setState","search","disconnecte","user","handleUser","handleVue","key","mytube","state","video","vue","videoSelected","isAlreadyLike","keyVideo","Already","undefined","Object","keys","likeBy","forEach","uid","handleLike","like","getPseudo","Testuser","pseudo","addNewUser","newUser","console","log","Date","now","getUser","addVideo","nom","tags","url","NewVideo","auteur","comment","tag","addComment","NewComment","refCard","createRef","refCardVideo","ref","syncState","context","removeBinding","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport './App.css';\r\nimport Nav from './component/Nav'\r\nimport AdminVideo from './component/AdminVideo'\r\nimport AdminVideoSelected from './component/AdminVideoSelected'\r\nimport AdminUpload from './component/AdminUpload'\r\nimport AdminVideoJaime from './component/AdminVideoJaime'\r\n\r\n//firebase\r\nimport base from './base'\r\n\r\n//react router\r\nimport{BrowserRouter as Router,Route} from 'react-router-dom'\r\n\r\nclass App extends React.Component{\r\n  constructor(props) {\r\n    super(props);\r\n    this.refCard = React.createRef();\r\n    this.refCardVideo = React.createRef();\r\n    \r\n    this.state ={\r\n      mytube:{},\r\n      search:'',\r\n      videoSelected:'',\r\n      user:{}\r\n    }\r\n  }\r\n   \r\n\r\n  componentDidMount(){\r\n    this.ref=base.syncState(`/`,{\r\n      context:this,\r\n      state: 'mytube'\r\n    })\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    base.removeBinding(this.ref);\r\n  }\r\n\r\n  handleSearch=(value)=>{\r\n    this.setState({search:value})\r\n    \r\n  }\r\n\r\n  disconnecte=()=>{\r\n    this.setState({user:''})\r\n  }\r\n\r\n  handleUser=(value)=>{\r\n    this.setState({user:value})\r\n  }\r\n  \r\n  handleVue=(key) => {\r\n    const mytube= {...this.state.mytube}\r\n    mytube.video[key].vue++;\r\n    this.setState({mytube})\r\n  \r\n    const videoSelected=key\r\n    this.setState({videoSelected})\r\n  }\r\n\r\n\r\n  isAlreadyLike=(keyVideo)=>{\r\n    const mytube= {...this.state.mytube}\r\n    let Already=false;\r\n    if(mytube!==undefined){\r\n      Object.keys(mytube.video[keyVideo].likeBy || {})\r\n            .forEach(key =>{\r\n                if(key===this.state.user.uid)\r\n                {\r\n                  if(mytube.video[keyVideo].likeBy[this.state.user.uid]===1){\r\n                     Already=true\r\n                  }\r\n                }\r\n            })\r\n\r\n      return  Already\r\n    }\r\n  }\r\n\r\n  handleLike = (key) => {\r\n  \r\n    if(this.state.user.uid!==undefined ){\r\n      const mytube= {...this.state.mytube}\r\n  \r\n   \r\n    if( mytube.video[key].likeBy===undefined){\r\n          mytube.video[key].likeBy={};\r\n    }\r\n     if(mytube.video[key].likeBy[this.state.user.uid]===undefined || mytube.video[key].likeBy[this.state.user.uid]===0){\r\n        mytube.video[key].like++\r\n        mytube.video[key].likeBy[this.state.user.uid]=1\r\n      }\r\n      else\r\n      {\r\n        mytube.video[key].like--\r\n        mytube.video[key].likeBy[this.state.user.uid]=0\r\n      }\r\n      this.setState({mytube})\r\n    }\r\n  }\r\n\r\n\r\n  getPseudo=(uid)=>{\r\n\r\n    const Testuser={...this.state.mytube.user}\r\n    let pseudo=''\r\n    Object.keys(Testuser || {})   //on vérifie que le compte n'a pas déja été créer\r\n        .forEach(key => {\r\n                      if((Testuser[key].uid===uid)){\r\n                        pseudo=Testuser[key].pseudo\r\n                      }\r\n                   }\r\n            );\r\n    return pseudo\r\n  }\r\n\r\n  addNewUser= async (uid,pseudo)=>{\r\n    const mytube={...this.state.mytube}\r\n\r\n    const newUser={\r\n      uid:uid,\r\n      pseudo:pseudo\r\n    }\r\n    console.log(newUser.pseudo)\r\n \r\n    mytube.user[`user-${Date.now()}`]=newUser\r\n    this.setState({mytube})\r\n    return newUser;\r\n  }\r\n\r\n  getUser=(uid,pseudo)=>{\r\n\r\n    const Testuser={...this.state.mytube.user}\r\n    let newUser={}\r\n    Object.keys(Testuser)   //on vérifie que le compte n'a pas déja été créer\r\n        .forEach(key => {\r\n                  if((Testuser[key].uid===uid)){\r\n                    newUser=Testuser[key];\r\n                  }\r\n             }\r\n        );\r\n    if(newUser.uid===undefined){    //si aucun compte n'a été ctrouver on en créer un\r\n      newUser=this.addNewUser(uid,pseudo)\r\n    }\r\n    this.setState({user:newUser})\r\n  }\r\n\r\n\r\n  addVideo=(nom,tags,url)=>{\r\n    const mytube={...this.state.mytube}\r\n    const NewVideo={\r\n      auteur:this.state.user.pseudo,\r\n      comment:{},\r\n      like:0,\r\n      likeBy:{},\r\n      nom:nom,\r\n      tag:tags,\r\n      url:url,\r\n      vue:0\r\n    }\r\n    mytube.video[`video${Date.now()}`]=NewVideo\r\n    this.setState({mytube})\r\n\r\n  }\r\n\r\n  addComment=(key,comment)=>{\r\n    if(this.state.user.uid!==undefined ){\r\n      const mytube= {...this.state.mytube}\r\n      if( mytube.video[key].comment===undefined ||mytube.video[key].comment===''){\r\n          mytube.video[key].comment={};\r\n      }\r\n\r\n      const NewComment={\r\n       auteur:this.state.user.pseudo,\r\n       comment:comment\r\n     }\r\n      mytube.video[key].comment[Date.now()]=NewComment\r\n      this.setState({mytube})\r\n    }\r\n  }\r\n\r\n  render(){\r\n    \r\n  //variable permettant la manipulation de la marge lors de l'activation du menu\r\n\r\n\r\n\r\n    return (\r\n      <>\r\n       <Router>\r\n         \r\n          <Nav state={this.state}  getPseudo={this.getPseudo} \r\n                  stateMytube={this.state.mytube.video} \r\n                  handleSearch={this.handleSearch} \r\n                  handleUser={this.handleUser} \r\n                  getUser={this.getUser} \r\n                  disconnecte={this.disconnecte}\r\n                  refCardVideo={this.refCardVideo}\r\n                  refCard={this.refCard}\r\n                  >\r\n          </Nav>\r\n        \r\n         <Route path='/' exact \r\n                render={()=><AdminVideo\r\n                            state={this.state} \r\n                            stateMytube={this.state.mytube.video} \r\n                            handleVue={this.handleVue}\r\n                            isAlreadyLike={this.isAlreadyLike}\r\n                            refCard={this.refCard}\r\n                          />\r\n                        }/>\r\n        \r\n         <Route path='/videoSelect/:slug' exact \r\n                render={()=><AdminVideoSelected \r\n                        state={this.state}\r\n                        isAlreadyLike={this.isAlreadyLike}\r\n                        stateMytube={this.state.mytube.video} \r\n                        handleLike={this.handleLike}\r\n                        refCardVideo={this.refCardVideo}\r\n                        refCard={this.refCard}\r\n                        addComment={this.addComment}\r\n                        handleVue={this.handleVue}\r\n                        />\r\n                        }/> \r\n\r\n          <Route path='/upload' exact \r\n                render={()=><AdminUpload state={this.state} \r\n                              stateMytube={this.state.mytube.video} \r\n                              addVideo={this.addVideo}\r\n                              refCard={this.refCard}\r\n                              isAlreadyLike={this.isAlreadyLike}/> \r\n                        }/>\r\n          \r\n          <Route path='/video/likes' exact \r\n                render={()=><AdminVideoJaime \r\n                              state={this.state} \r\n                              stateMytube={this.state.mytube.video} \r\n                              refCard={this.refCard}\r\n                              isAlreadyLike={this.isAlreadyLike}\r\n                              typeJaime={true}/> \r\n                        }/>\r\n          \r\n          \r\n\r\n      </Router> \r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}