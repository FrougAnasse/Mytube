{"ast":null,"code":"import _defineProperty from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/VolgoBox/Desktop/Mytube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React from'react';import'./App.css';import Nav from'./component/Nav';import AdminVideo from'./component/AdminVideo';import AdminVideoSelected from'./component/AdminVideoSelected';import AdminUpload from'./component/AdminUpload';import AdminVideoJaime from'./component/AdminVideoJaime';//firebase\nimport base from'./base';//react router\nimport{BrowserRouter as Router,Route}from'react-router-dom';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.handleSearch=function(value){_this.setState({search:value});};_this.disconnecte=function(){_this.setState({user:''});};_this.handleUser=function(value){var id=_this.state.user.uid;_this.setState({user:value});};_this.handleVue=function(key){var mytube=_objectSpread({},_this.state.mytube);mytube.video[key].vue++;_this.setState({mytube:mytube});var videoSelected=key;_this.setState({videoSelected:videoSelected});};_this.isAlreadyLike=function(keyVideo){var mytube=_objectSpread({},_this.state.mytube);var Already=false;if(mytube!==undefined){Object.keys(mytube.video[keyVideo].likeBy||{}).map(function(key){if(key===_this.state.user.uid){if(mytube.video[keyVideo].likeBy[_this.state.user.uid]===1)Already=true;}});return Already;}};_this.handleLike=function(key){console.log(_this.state.user.uid!==undefined);if(_this.state.user.uid!==undefined){var mytube=_objectSpread({},_this.state.mytube);console.log(key);console.log(_this.isAlreadyLike(key));if(mytube.video[key].likeBy===undefined){mytube.video[key].likeBy={};}if(mytube.video[key].likeBy[_this.state.user.uid]===undefined||mytube.video[key].likeBy[_this.state.user.uid]===0){mytube.video[key].like++;mytube.video[key].likeBy[_this.state.user.uid]=1;}else{mytube.video[key].like--;mytube.video[key].likeBy[_this.state.user.uid]=0;}_this.setState({mytube:mytube});}};_this.getPseudo=function(uid){console.log('in pseudo '+uid);var Testuser=_objectSpread({},_this.state.mytube.user);var pseudo='';Object.keys(Testuser||{})//on vérifie que le compte n'a pas déja été créer\n.map(function(key){if(Testuser[key].uid===uid){pseudo=Testuser[key].pseudo;}});return pseudo;};_this.addNewUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(uid){var Testuser,mytube,pseudoUid,newUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Testuser=_objectSpread({},_this.state.mytube.user);console.log('in add new user '+uid);mytube=_objectSpread({},_this.state.mytube);pseudoUid=_this.getPseudo(uid);console.log('new user pseudo trouver'+pseudoUid);if(pseudoUid===''){pseudoUid=prompt(\"Veuillez rentrer votre pseudo attention il est      définitive !\");console.log('prompt======'+pseudoUid);}newUser={uid:uid,pseudo:pseudoUid};mytube.user[\"user-\".concat(Date.now())]=newUser;_this.setState({mytube:mytube});console.log(newUser);return _context.abrupt(\"return\",newUser);case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.getUser=function(uid){console.log('in get user '+uid);var Testuser=_objectSpread({},_this.state.mytube.user);console.log('test  ');console.log(Testuser);var newUser={};Object.keys(Testuser)//on vérifie que le compte n'a pas déja été créer\n.map(function(key){if(Testuser[key].uid===uid){newUser=Testuser[key];}});if(newUser.uid===undefined){//si aucun compte n'a été ctrouver on en créer un\nconsole.log('new new new new');newUser=_this.addNewUser(uid);}console.log(newUser);var user=_objectSpread({},_this.state.user);//mise à jour du sate user local \n_this.setState({user:newUser});};_this.addVideo=function(nom,tags,url){var mytube=_objectSpread({},_this.state.mytube);var NewVideo={auteur:_this.state.user.pseudo,comment:'',like:0,likeBy:{},nom:nom,tag:tags,url:url,vue:0};mytube.video[\"video\".concat(Date.now())]=NewVideo;_this.setState({mytube:mytube});console.log(mytube);};_this.refCard=/*#__PURE__*/React.createRef();_this.refCardVideo=/*#__PURE__*/React.createRef();_this.state={mytube:{},search:'',videoSelected:'',user:{}};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){this.ref=base.syncState(\"/\",{context:this,state:'mytube'});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){base.removeBinding(this.ref);}},{key:\"render\",value:function render(){var _this2=this;//variable permettant la manipulation de la marge lors de l'activation du menu\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(Nav,{state:this.state,getPseudo:this.getPseudo,stateMytube:this.state.mytube.video,handleSearch:this.handleSearch,handleUser:this.handleUser,getUser:this.getUser,disconnecte:this.disconnecte,refCardVideo:this.refCardVideo,refCard:this.refCard}),/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,render:function render(){var _jsx2;return/*#__PURE__*/_jsx(AdminVideo,(_jsx2={state:_this2.state,stateMytube:_this2.state.mytube.video,handleVue:_this2.handleVue,isAlreadyLike:_this2.isAlreadyLike},_defineProperty(_jsx2,\"stateMytube\",_this2.state.mytube.video),_defineProperty(_jsx2,\"refCard\",_this2.refCard),_jsx2));}}),/*#__PURE__*/_jsx(Route,{path:\"/video/:slug\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminVideoSelected,{state:_this2.state,isAlreadyLike:_this2.isAlreadyLike,stateMytube:_this2.state.mytube.video,handleLike:_this2.handleLike,refCardVideo:_this2.refCardVideo,refCard:_this2.refCard});}}),/*#__PURE__*/_jsx(Route,{path:\"/upload\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminUpload,{state:_this2.state,stateMytube:_this2.state.mytube.video,addVideo:_this2.addVideo,refCard:_this2.refCard,isAlreadyLike:_this2.isAlreadyLike});}}),/*#__PURE__*/_jsx(Route,{path:\"/video/likes\",exact:true,render:function render(){return/*#__PURE__*/_jsx(AdminVideoJaime,{state:_this2.state,stateMytube:_this2.state.mytube.video,refCard:_this2.refCard,isAlreadyLike:_this2.isAlreadyLike});}})]})});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["C:/Users/VolgoBox/Desktop/Mytube/src/App.js"],"names":["React","Nav","AdminVideo","AdminVideoSelected","AdminUpload","AdminVideoJaime","base","BrowserRouter","Router","Route","App","props","handleSearch","value","setState","search","disconnecte","user","handleUser","id","state","uid","handleVue","key","mytube","video","vue","videoSelected","isAlreadyLike","keyVideo","Already","undefined","Object","keys","likeBy","map","handleLike","console","log","like","getPseudo","Testuser","pseudo","addNewUser","pseudoUid","prompt","newUser","Date","now","getUser","addVideo","nom","tags","url","NewVideo","auteur","comment","tag","refCard","createRef","refCardVideo","ref","syncState","context","removeBinding","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport './App.css';\r\nimport Nav from './component/Nav'\r\nimport AdminVideo from './component/AdminVideo'\r\nimport AdminVideoSelected from './component/AdminVideoSelected'\r\nimport AdminUpload from './component/AdminUpload'\r\nimport AdminVideoJaime from './component/AdminVideoJaime'\r\n\r\n//firebase\r\nimport base from './base'\r\n\r\n//react router\r\nimport{BrowserRouter as Router,Route} from 'react-router-dom'\r\n\r\nclass App extends React.Component{\r\n  constructor(props) {\r\n    super(props);\r\n    this.refCard = React.createRef();\r\n    this.refCardVideo = React.createRef();\r\n    \r\n    this.state ={\r\n      mytube:{},\r\n      search:'',\r\n      videoSelected:'',\r\n      user:{}\r\n    }\r\n  }\r\n   \r\n\r\n  componentDidMount(){\r\n    this.ref=base.syncState(`/`,{\r\n      context:this,\r\n      state: 'mytube'\r\n    })\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    base.removeBinding(this.ref);\r\n  }\r\n\r\n  handleSearch=(value)=>{\r\n    this.setState({search:value})\r\n  }\r\n\r\n  disconnecte=()=>{\r\n    this.setState({user:''})\r\n  }\r\n\r\n  handleUser=(value)=>{\r\n    const id=this.state.user.uid\r\n    this.setState({user:value})\r\n  }\r\n  \r\n  handleVue=(key) => {\r\n    const mytube= {...this.state.mytube}\r\n    mytube.video[key].vue++;\r\n    this.setState({mytube})\r\n  \r\n    const videoSelected=key\r\n    this.setState({videoSelected})\r\n  }\r\n\r\n\r\n  isAlreadyLike=(keyVideo)=>{\r\n    const mytube= {...this.state.mytube}\r\n    let Already=false;\r\n    if(mytube!==undefined){\r\n      Object.keys(mytube.video[keyVideo].likeBy || {})\r\n            .map(key =>{\r\n                if(key===this.state.user.uid){\r\n                  if(mytube.video[keyVideo].likeBy[this.state.user.uid]===1)\r\n                  Already=true\r\n                }\r\n            })\r\n\r\n      return  Already\r\n    }\r\n  }\r\n\r\n  handleLike = (key) => {\r\n    console.log(this.state.user.uid!==undefined)\r\n    if(this.state.user.uid!==undefined ){\r\n      const mytube= {...this.state.mytube}\r\n      console.log(key)\r\n      console.log(this.isAlreadyLike(key))\r\n   \r\n    if( mytube.video[key].likeBy===undefined){\r\n          mytube.video[key].likeBy={};\r\n    }\r\n     if(mytube.video[key].likeBy[this.state.user.uid]===undefined || mytube.video[key].likeBy[this.state.user.uid]===0){\r\n        mytube.video[key].like++\r\n        mytube.video[key].likeBy[this.state.user.uid]=1\r\n      }\r\n      else\r\n      {\r\n        mytube.video[key].like--\r\n        mytube.video[key].likeBy[this.state.user.uid]=0\r\n      }\r\n      this.setState({mytube})\r\n    }\r\n  }\r\n\r\n\r\n  getPseudo=(uid)=>{\r\n    console.log('in pseudo '+uid)\r\n    const Testuser={...this.state.mytube.user}\r\n    let pseudo=''\r\n    Object.keys(Testuser || {})   //on vérifie que le compte n'a pas déja été créer\r\n        .map(key => {\r\n                      if((Testuser[key].uid===uid)){\r\n                        pseudo=Testuser[key].pseudo\r\n                      }\r\n                   }\r\n            );\r\n    return pseudo\r\n  }\r\n\r\n  addNewUser= async (uid)=>{\r\n    const Testuser={...this.state.mytube.user}\r\n    console.log('in add new user '+uid)\r\n    const mytube={...this.state.mytube}\r\n    let pseudoUid=this.getPseudo(uid)\r\n    console.log('new user pseudo trouver'+pseudoUid)\r\n    \r\n    if(pseudoUid===''){\r\n        pseudoUid= prompt(\"Veuillez rentrer votre pseudo attention il est      définitive !\")\r\n        console.log('prompt======'+pseudoUid)\r\n    }\r\n\r\n    const newUser={\r\n      uid:uid,\r\n      pseudo:pseudoUid\r\n    }\r\n    mytube.user[`user-${Date.now()}`]=newUser\r\n    this.setState({mytube})\r\n    console.log(newUser)\r\n    return newUser;\r\n  }\r\n\r\n  getUser=(uid)=>{\r\n    console.log('in get user '+uid)\r\n    const Testuser={...this.state.mytube.user}\r\n    console.log('test  ')\r\n    console.log(Testuser)\r\n    let newUser={}\r\n    Object.keys(Testuser)   //on vérifie que le compte n'a pas déja été créer\r\n        .map(key => {\r\n                  if((Testuser[key].uid===uid)){\r\n                    newUser=Testuser[key];\r\n                  }\r\n             }\r\n        );\r\n    if(newUser.uid===undefined){    //si aucun compte n'a été ctrouver on en créer un\r\n     console.log('new new new new')\r\n      newUser=this.addNewUser(uid)\r\n    }\r\n    console.log(newUser)\r\n    const user={...this.state.user}   //mise à jour du sate user local \r\n    this.setState({user:newUser})\r\n  }\r\n\r\n\r\n  addVideo=(nom,tags,url)=>{\r\n    const mytube={...this.state.mytube}\r\n    const NewVideo={\r\n      auteur:this.state.user.pseudo,\r\n      comment:'',\r\n      like:0,\r\n      likeBy:{},\r\n      nom:nom,\r\n      tag:tags,\r\n      url:url,\r\n      vue:0\r\n    }\r\n    mytube.video[`video${Date.now()}`]=NewVideo\r\n    this.setState({mytube})\r\n    console.log(mytube)\r\n  }\r\n\r\n  render(){\r\n    \r\n  //variable permettant la manipulation de la marge lors de l'activation du menu\r\n\r\n\r\n\r\n    return (\r\n      <>\r\n       <Router>\r\n         \r\n          <Nav state={this.state}  getPseudo={this.getPseudo} \r\n                  stateMytube={this.state.mytube.video} \r\n                  handleSearch={this.handleSearch} \r\n                  handleUser={this.handleUser} \r\n                  getUser={this.getUser} \r\n                  disconnecte={this.disconnecte}\r\n                  refCardVideo={this.refCardVideo}\r\n                  refCard={this.refCard}\r\n                  >\r\n          </Nav>\r\n        \r\n         <Route path='/' exact \r\n                render={()=><AdminVideo state={this.state} \r\n                            stateMytube={this.state.mytube.video} \r\n                            handleVue={this.handleVue}\r\n                            isAlreadyLike={this.isAlreadyLike}\r\n                            stateMytube={this.state.mytube.video} \r\n                            refCard={this.refCard}\r\n                          />\r\n                        }/>\r\n        \r\n         <Route path='/video/:slug' exact \r\n                render={()=><AdminVideoSelected \r\n                        state={this.state}\r\n                        isAlreadyLike={this.isAlreadyLike}\r\n                        stateMytube={this.state.mytube.video} \r\n                        handleLike={this.handleLike}\r\n                        refCardVideo={this.refCardVideo}\r\n                        refCard={this.refCard}\r\n                        />\r\n                        }/> \r\n\r\n          <Route path='/upload' exact \r\n                render={()=><AdminUpload state={this.state} \r\n                              stateMytube={this.state.mytube.video} \r\n                              addVideo={this.addVideo}\r\n                              refCard={this.refCard}\r\n                              isAlreadyLike={this.isAlreadyLike}/> \r\n                        }/>\r\n          \r\n          <Route path='/video/likes' exact \r\n                render={()=><AdminVideoJaime state={this.state} \r\n                              stateMytube={this.state.mytube.video} \r\n                              refCard={this.refCard}\r\n                              isAlreadyLike={this.isAlreadyLike}/> \r\n                        }/>\r\n          \r\n          \r\n\r\n      </Router> \r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}